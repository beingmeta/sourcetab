#!/bin/sh
SOURCETAB=${1:-@ETC@/srctab}
SOURCETABD=${1:-@ETC@/sourcetab.d}
sourcetab_command()
{
	grep -v "^\s*$" | grep -v "^[ 	]*[#;]" | awk -f @LIBDIR@/sourcetab.awk;
}
generate_upsource_commands()
{
    if test -f @LIBDIR@/config; then cat @LIBDIR@/config; fi;
    if test -f ${SOURCETAB}; then cat ${SOURCETAB} | sourcetab_command;
    if test -d ${SOURCTABD}; then
	for tab in ${SOURCTABD}/*.srctab; do
	    cat ${tab} | sourcetab_command; done
}

for pre in @LIBDIR@/handlers/*.pre; do
    if test -x ${pre}; then ${pre}; fi; done

generate_upsource_commands | bash

for run in @RUNDIR@/*.post; do
    if test -f ${run}; then ${run}; fi; done

for post in @LIBDIR@/handlers/*.post; do
    if test -x ${post}; then ${post}; fi; done

